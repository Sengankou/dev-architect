# ğŸ“‹ Dev Architect é–‹ç™ºé€²æ—ç®¡ç†

**æœ€çµ‚æ›´æ–°**: 2025-10-24

---

## ğŸ¯ ç¾åœ¨åœ°

**Phase 1: Mastraçµ±åˆã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼éª¨æ ¼æ§‹ç¯‰** ã‚’é€²è¡Œä¸­

**ç¾åœ¨ä½œæ¥­**: Phase 1-4ï¼ˆ/api/specã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…ï¼‰â† ä»Šã‚³ã‚³

é€²æ—: **50%** (3/6ã‚¿ã‚¹ã‚¯å®Œäº†)

---

## Phase 1: Mastraçµ±åˆã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼éª¨æ ¼æ§‹ç¯‰

**ç›®çš„**: Mastraã‚’å°å…¥ã—ã€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã—ã¦ä»•æ§˜æ›¸ç”Ÿæˆã®æœ€å°ãƒ•ãƒ­ãƒ¼ã‚’ç¢ºç«‹ã™ã‚‹

| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | ã‚¿ã‚¹ã‚¯ | è©³ç´° | å‚™è€ƒ |
|:---:|:---|:---|:---|
| âœ… | Phase 1-1 | mastraã¨ãã®ä¾å­˜ã‚’è¿½åŠ  | `pnpm add mastra @mastra/core @ai-sdk/google zod` å®Œäº† |
| âœ… | Phase 1-2 | mastra.config.tsä½œæˆ | Gemini 2.5 Flashè¨­å®šå®Œäº† |
| âœ… | Phase 1-3 | generateSpecãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä½œæˆ | Mastraå…¬å¼æ§‹é€ ã«å¾“ã„`src/mastra/`é…ä¸‹ã«å®Ÿè£…å®Œäº† |
| ğŸš§ | Phase 1-4 | /api/specã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£… | **â† ä»Šã‚³ã‚³** ä»•æ§˜æ˜ç¢ºåŒ–å®Œäº†ã€å®Ÿè£…æº–å‚™OK |
| â³ | Phase 1-5 | KV/D1ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°çµ±åˆ | sessionä»®ä¿å­˜ã€çµæœæ°¸ç¶šåŒ–ã€ã‚¹ã‚­ãƒ¼ãƒä½œæˆ |
| â³ | Phase 1-6 | å‹•ä½œç¢ºèªãƒ†ã‚¹ãƒˆ | curl/wrangler devçµŒç”±ã§POSTâ†’ä»•æ§˜æ›¸è‰ç¨¿ç¢ºèª |

### Phase 1-4 ä»•æ§˜æ˜ç¢ºåŒ–çµæœï¼ˆ2025-10-24ï¼‰

**APIä»•æ§˜**:
- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: `POST /api/spec`
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆ: `{ "requirements": "string", "projectName": "string?" }`
- æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹: `{ "analysis": {}, "architecture": {}, "specificationDraft": "string" }`
- ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹: `{ "error": { "message": "string", "code": "string" } }`
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: 60ç§’

**D1ã‚¹ã‚­ãƒ¼ãƒï¼ˆspecsãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰**:
- `id` (INTEGER PRIMARY KEY)
- `requirements` (TEXT NOT NULL)
- `project_name` (TEXT)
- `analysis_json` (TEXT NOT NULL)
- `architecture_json` (TEXT NOT NULL)
- `spec_draft` (TEXT NOT NULL)
- `created_at` (INTEGER NOT NULL)

### Phase 1 å®Œäº†æ¡ä»¶

- [ ] `/api/spec` ã«JSONã§è¦ä»¶ã‚’æŠ•ã’ã‚‹ã¨ã€LLMãŒæ§‹æˆã¨ä»•æ§˜æ›¸è‰ç¨¿ã‚’è¿”ã™
- [ ] D1ã«`spec`ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒ1ä»¶ä¿å­˜ã•ã‚Œã‚‹
- [ ] é–‹ç™ºç’°å¢ƒã§MastraãŒæ­£å¸¸ç¨¼åƒ

### Phase 1 æˆæœç‰©

```
src/
 â”œâ”€â”€ index.ts                      # Honoã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
 â”œâ”€â”€ mastra/                       # Mastraã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
 â”‚   â”œâ”€â”€ index.ts                  # Mastraã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
 â”‚   â””â”€â”€ workflows/
 â”‚       â””â”€â”€ generateSpec.ts       # ä»•æ§˜æ›¸ç”Ÿæˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
 â””â”€â”€ routes/
     â””â”€â”€ spec.ts                   # /api/spec ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
mastra.config.ts                   # ï¼ˆå‰Šé™¤äºˆå®šã€src/mastra/index.tsã«çµ±åˆæ¸ˆã¿ï¼‰
```

---

## Phase 2: å¯¾è©±ãƒ•ãƒ­ãƒ¼ + ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†

**ç›®çš„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®ãƒãƒ«ãƒã‚¿ãƒ¼ãƒ³ä¼šè©±ã‚’å®Ÿç¾ã—ã€è¦ä»¶ã‚’å¯¾è©±çš„ã«ç²¾ç·»åŒ–ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹

| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | ã‚¿ã‚¹ã‚¯ | è©³ç´° |
|:---:|:---|:---|
| â¬œ | Phase 2-1 | /api/chat APIè¨­è¨ˆ | POSTã€KVã«session_idå˜ä½ã§å±¥æ­´ä¿å­˜ |
| â¬œ | Phase 2-2 | ãƒ•ãƒ­ãƒ¼æ‹¡å¼µ | generateSpecåˆ†å‰²ã€statefulåŒ– |
| â¬œ | Phase 2-3 | UIè©¦ä½œ | Cloudflare Pagesã§ç°¡æ˜“ãƒãƒ£ãƒƒãƒˆUIï¼ˆReact/Viteï¼‰ |
| â¬œ | Phase 2-4 | DBé€£æº | D1ã«sessions/specs/messagesãƒ†ãƒ¼ãƒ–ãƒ«æ‹¡å¼µ |
| â¬œ | Phase 2-5 | ã‚»ãƒƒã‚·ãƒ§ãƒ³å¾©å…ƒ | KVâ†’D1åŒæœŸã€ãƒãƒ£ãƒƒãƒˆå†é–‹æ™‚ã«å±¥æ­´å†ç¾ |

### Phase 2 å®Œäº†æ¡ä»¶

- [ ] Web UI or curlã§è¦ä»¶ã‚’ä¼šè©±çš„ã«å…¥åŠ›ã§ãã‚‹
- [ ] KVã«å±¥æ­´ãŒæ®‹ã‚Šã€D1ã«çµ±åˆè¨˜éŒ²ã•ã‚Œã‚‹
- [ ] MastraãŒä¼šè©±æ–‡è„ˆã‚’ä¿æŒã—ã¦ä»•æ§˜æ›¸ã‚’æ›´æ–°ã§ãã‚‹

### Phase 2 æˆæœç‰©

```
src/
 â”œâ”€â”€ routes/chat.ts
 â”œâ”€â”€ workflows/
 â”‚    â”œâ”€â”€ analyzeRequirements.ts
 â”‚    â”œâ”€â”€ refineConstraints.ts
 â”‚    â””â”€â”€ generateSpec.ts
 â””â”€â”€ utils/sessionStore.ts
```

---

## Phase 3: PDFï¼è³‡æ–™é€£æº

**ç›®çš„**: PDFã‚„æ—¢å­˜ä»•æ§˜æ›¸ã‚’å–ã‚Šè¾¼ã¿ã€å†…å®¹ã‚’è§£æã—ã¦ä»•æ§˜ç”Ÿæˆã«åæ˜ ã™ã‚‹

| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | ã‚¿ã‚¹ã‚¯ | è©³ç´° |
|:---:|:---|:---|
| â¬œ | Phase 3-1 | R2é€£æº | PDFã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰â†’R2ä¿å­˜â†’ç½²åURLç™ºè¡Œ |
| â¬œ | Phase 3-2 | æŠ½å‡ºå‡¦ç† | /api/uploadã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€PDFâ†’ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º |
| â¬œ | Phase 3-3 | Mastraçµ±åˆ | generateSpecå…¥åŠ›ã«PDFæŠ½å‡ºãƒ†ã‚­ã‚¹ãƒˆçµ„ã¿è¾¼ã¿ |
| â¬œ | Phase 3-4 | D1ç™»éŒ² | documentsãƒ†ãƒ¼ãƒ–ãƒ«ã€ä»•æ§˜æ›¸ãƒ¬ã‚³ãƒ¼ãƒ‰ã¨ç´ä»˜ã‘ |
| â¬œ | Phase 3-5 | ç¢ºèªUI | ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿è³‡æ–™ä¸€è¦§/å†åˆ©ç”¨ |

### Phase 3 å®Œäº†æ¡ä»¶

- [ ] PDFã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰â†’ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡ºâ†’ä»•æ§˜ç”Ÿæˆã¾ã§è‡ªå‹•åŒ–
- [ ] R2ã¨D1ã§ãƒ•ã‚¡ã‚¤ãƒ«ã¨ä»•æ§˜æ›¸ã®ç´ä»˜ã‘ãŒç¢ºèªã§ãã‚‹
- [ ] APIå±¤ãŒä¸€è²«ã—ã¦å‹•ä½œ

### Phase 3 æˆæœç‰©

```
src/
 â”œâ”€â”€ routes/upload.ts
 â”œâ”€â”€ services/pdfParser.ts
 â””â”€â”€ workflows/generateSpec.tsï¼ˆPDFå¯¾å¿œç‰ˆï¼‰
```

---

## ğŸ“ˆ å…¨ä½“é€²æ—ã‚µãƒãƒªãƒ¼

| Phase | åç§° | é€²æ— | ä¸»è¦æŠ€è¡“ | å®Œäº†ç›®æ¨™ |
|:---:|:---|:---:|:---|:---|
| 1 | Mastraçµ±åˆã¨éª¨æ ¼ | ğŸš§ 33% | Mastra / Hono / D1 | `/api/spec`ã§ä»•æ§˜æ›¸ç”Ÿæˆ |
| 2 | å¯¾è©±ãƒ•ãƒ­ãƒ¼ | â¬œ 0% | KV / Hono / Pages | è¦ä»¶â†’ä»•æ§˜æ›´æ–°ãƒãƒ£ãƒƒãƒˆ |
| 3 | PDFé€£æº | â¬œ 0% | R2 / Mastra | PDFâ†’ä»•æ§˜æ›¸ç”Ÿæˆ |

**ç·åˆé€²æ—**: ğŸš§ 11% (2/18ã‚¿ã‚¹ã‚¯å®Œäº†)

---

## ğŸ“ ãƒ¡ãƒ¢ãƒ»èª²é¡Œ

- zod v4.1.12ã¨ai SDKã®peer dependencyè­¦å‘Šã‚ã‚Šï¼ˆå‹•ä½œã«ã¯å½±éŸ¿ãªã—ï¼‰
- Gemini APIã‚­ãƒ¼ã¯ç’°å¢ƒå¤‰æ•°`GOOGLE_GENERATIVE_AI_API_KEY`ã‹ã‚‰å–å¾—ã™ã‚‹è¨­å®š
- wrangler.tomlãŒç©ºã®çŠ¶æ…‹ â†’ ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°è¨­å®šãŒå¿…è¦
- TypeScriptå‹ãƒã‚§ãƒƒã‚¯: âœ… ã‚¨ãƒ©ãƒ¼ãªã—ï¼ˆnpx tsc --noEmitï¼‰

---

## ğŸ”„ æ›´æ–°å±¥æ­´

- 2025-10-24: Phase 1é–‹å§‹ã€1-1å®Œäº†ï¼ˆmastra/@ai-sdk/googleå°å…¥ï¼‰
- 2025-10-24: 1-2å®Œäº†ï¼ˆGemini 2.5 Flashè¨­å®šï¼‰
- 2025-10-24: 1-3å®Œäº†ï¼ˆMastraå…¬å¼æ§‹é€ ã§ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè£…ï¼‰ã€1-4ç€æ‰‹
